@import 'variables';

@mixin clearfix {
    &::after {
        display: table;
        clear: both;
        content: '';
    }
}

// code from https://github.com/hudochenkov/sass-text-stroke
@function text-stroke($size: 2, $color: $white, $correction: 0) {
    $radius: $size - $correction;
    $stroke: ();

    @for $i from -$size through $size {
        @for $k from -$size through $size {

            $x: $k;
            $y: $i;

            @if $k > 0 {
                $x: $k - .5;
            } @elseif $k < 0 {
                $x: $k + .5;
            }

            @if $i > 0 {
                $y: $i - .5;
            } @elseif $i < 0 {
                $y: $i + .5;
            }

            @if ($x * $x + $y * $y <= $radius * $radius) {
                $stroke: append($stroke, $i * 1px $k * 1px 0 $color, comma);
            }
        }
    }

    @return $stroke;
}

@mixin text-stroke($size: 2, $color: $white, $correction: 0) {
    text-shadow: text-stroke($size, $color, $correction);
}

@mixin score-meter($steps: 4, $meter-color: $light-green) {
    display: inline-block;
    position: relative;
    z-index: 1;
    margin: 10px 0 10px 40px;
    width: 200px;
    height: 20px;
    vertical-align: middle;

    &::after {
        position: absolute;
        bottom: 0;
        left: 5%;
        opacity: .6;
        z-index: 1;
        border-radius: 10px;
        background-color: $light-grey;
        width: 90%;
        height: 6px;
        content: '';
    }

    span {
        display: block;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        color: transparent;
        font-size: 0;

        &::before {
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            border: 3px solid $black;
            border-radius: 50px;
            background-color: $white;
            width: 100%;
            height: 100%;
            content: '';
        }

        &::after {
            display: block;
            position: absolute;
            top: 3px;
            left: 3px;

            // scss-lint:disable VendorPrefix
            -webkit-transition: width .5s cubic-bezier(.53, 0, .63, 1);
            // scss-lint:enable VendorPrefix
            transition: width .5s cubic-bezier(.53, -.56, .63, 1.74);

            border-radius: 50px;
            background-color: $meter-color;
            width: 0;
            height: 100%;
            content: '';
        }
    }

    @for $i from 0 through $steps {
        &.score-#{$i} {
            span::after {
                width: percentage($i / $steps);
            }
        }
    }
}

@mixin life-tracker() {
    &::before,
    &::after {
        content: '';
    }

    &::before,
    span,
    &::after {
        display: inline-block;
        position: relative;
        transition: opacity .5s;
        opacity: .5;
        background-repeat: no-repeat;
        vertical-align: middle;
    }

    span {
        color: transparent;
        font-size: 0;
    }

    &.score-1::before,
    &.score-2::before,
    &.score-2 span,
    &.score-3::before,
    &.score-3 span,
    &.score-3::after {
        opacity: 1;
    }
}
