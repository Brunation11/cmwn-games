<audio class="background" src="media/_audio/_BKG/MON_BKG_3.mp3" preload="none" loop></audio>
<audio pl-id="lifespan" class="voice-over" src="media/_audio/S_Reveal4Stages/VO_MonarchLifespan.mp3" preload="none" pl-required></audio>
<img src="media/_Images/S_4Generations/IMG_9.1.png" draggable=false>
<div pl-component="selectable-reveal" pl-select-state="highlight">
    <audio pl-id="button" class="sfx" src="media/_audio/_Buttons/MON_BU_3.mp3" preload="none"></audio>
    <div pl-component="reveal" pl-bg="media/_Images/_Frames/MON_FR_3.png">
        <audio class="voice-over" src="media/_audio/S_4Generations/VO_4Generations.mp3" preload="none" pl-required></audio>
        <audio class="voice-over" src="media/_audio/S_2WeekLife/VO_2WeekLife.mp3" preload="none" pl-required></audio>
        <audio class="voice-over" src="media/_audio/S_9Months/VO_9Months.mp3" preload="none" pl-required></audio>
        <audio class="voice-over" src="media/_audio/S_MigrateNorth/VO_MigrateNorth.mp3" preload="none" pl-required></audio>
        <audio class="voice-over" src="media/_audio/S_Reveal4Stages/VO_ClickReveal.mp3" preload="none" pl-required></audio>
        <ul class="items">
            <li>
                Every summer Monarchs<br>
                produce four generations.
            </li>
            <!-- 2_WEEK_LIFE -->
            <li>
                The first three generations<br>
                have 2-6 week life spans.
            </li>
            <!-- 9_MONTHS -->
            <li>
                The fourth generation will migrate south<br>
                for the winter and this group can<br>
                live up to 9 months!
            </li>
            <!-- MIGRATE_NORTH -->
            <li>
                The butterfly generations mature<br>
                and continue migrating north.
            </li>
            <li>
                Click to reveal the four stages<br>
                over the generations of Monarchs.
            </li>
        </ul>
    </div>
    <div pl-component="selectable">
        <img class="hidden" src="media/_Images/S_4Generations/IMG_9.3.png" draggable=false>
        <ul class="items" pl-bg="media/_Images/S_4Generations/IMG_9.2.png" pl-action="select(target('li'))">
            <li></li>
            <li></li>
            <li></li>
            <li></li>
        </ul>
    </div>
</div>

<script type="application/javascript">
    window._screenDeferred(
        this.screen('four-generations', function () {
            this.on('ui-open', function () {
                this.deselect(this.selectableReveal.reveal.find('li'));
            });

            this.on('audio-ended', function (_event) {
                if (this.audio.voiceOver.lifespan === _event.target) {
                    this.selectableReveal.reveal.item(4);
                }
            });

            this.entity('selectable-reveal', function () {
                this.start = function () {};

                this.respond('select', function (_event) {
                    var index, stateMethod;

                    index = _event.message;
                    stateMethod = this.properties.selectState || 'select';

                    if (~index) {
                        this[stateMethod](_event.behaviorTarget);
                        if (this.audio.sfx.button) this.audio.sfx.button.play();
                        this.reveal.item(index);
                    }
                });

                this.entity('selectable', function () {

                    this.shouldSelect = function (_$target) {
                        if (_$target.prev().hasClass(this.STATE.HIGHLIGHTED) || _$target.index() === 0) {
                            return !this.screen.state(this.STATE.VOICE_OVER);
                        }

                        return false;
                    };

                });
            });
        });
    )
</script>